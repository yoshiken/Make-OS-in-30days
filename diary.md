## 環境構築

一番最初に環境を作ろうと思い、公式webに出向いた。
付属のCD-ROMはしっかりついて来てるけど、作業予定のPCにDVDドライブ付いてなくて、いちいち外付けDVDドライブ出すのめんどくさいなと。

なんかダウンロードしたけどwindows10だと動かないツールばっかりだったので手動で随時集める方針にした。

まず最初にバイナリエディタとして"Binary Editor Bz"をダウンロード。

公式ページは↓

[Bz - c.mos](http://www.vcraft.jp/soft/bz.html)


個人的にはStirlingのほうが使い慣れた感があるけど書籍だとBZで後々BZ特有の機能とか出たら困るので一旦BZで行く。

強い意志を持った人間は任意のバイナリエディタでいいんじゃないんですか。


## Hello World

というわけで、早速バイナリをポチポチした。

手書きで必死こいてやってたけど調べてみたら皆さんプログラムで00埋めのバイナリデータを生成してたんですね。皆さん頭いいなぁ。

ここで添付されたQEMUが古すぎて機能しないので最新のQEMUをダウンロードした。

QEMUが初めてだったので色々調べた。何も引数入れないで単体をコマンドプロンプト上で実行するとヘルプが出たので見た感じ使うオプションは`-L`と`-fda`ぽかった。

`-L`はBIOSのあるディレクトリを渡す。`-fda`はFloppyDiskImageの略っぽい。ので今回作成したhelloos.imgを渡す。つまりは↓のようなコマンドを入力すればいい。

`QEMUPath -L QEMUBIOSDirectoryPath -fda ImgPath`

例えば以下のディレクトリ構造の場合こうなると仮定して、hellos.imgが存在しているディレクトリをカレントディレクトリとすると、

```
|--30dayOS
|  |--helloos.img
|
|--qemu
   |--qemu.exe
   |--bios.bin
   |--…
```

`..\qemu\qemu.exe -L ..\qemu -fda helloos.img`

となる。

が、`Could not open '/dev/kqemu' - QEMU acceleration layer not activated: No such file or directory`と出て起動しなくてワケワカランとなり、ここで躓きたくないので妥協してVMWareを使った。

VMWareでは`新規仮想マシンの作成`→`後でOSをインストール`→ゲストOSは好きなやつ(例えばその他→MS-DOS)→後は適当に→`ハードウェアカスタマイズ`→`追加`→`フロッピードライブ`→`完了`→`フロッピーイメージファイルを使用する`→`参照`→作成したhello.imgを指定

これでFDimgからbootができる。

自分の場合なんか起動しなくて色々試してだめだったのでここで一回不貞寝した。

起きてもう一回見直したらバイナリデータの`0`と`D`を間違えてた。見づらいんじゃ！

無事起動してニッコリ。



